# World Data League 2022


## 🎯 Challenge


Predicting the flow of people for public transportation improvements

## Team Name
CAPE

## 👥 Authors
* Akshay Punjabi
* Enrico Coluccia
* Pablo Izquierdo Ayala
* Chiara Rucco


## ✨ Introduction


Air pollution is a big issue and proposes a big challenge in our modern world. Not only is a high level of pollution directly linked with climate change, but it is also well documented the negative impact a prolonged exposure to high levels of pollution will have on our health. 
The European Environment Agency (EEA) describes it as a major cause of premature death and disease, and the largest environmental health risk in Europe (cite https://www.eea.europa.eu/themes/air/health-impacts-of-air-pollution) This is also backed by recent articles, some claiming that long term exposure is even linked to heightened autoimmune disease risk (cite
https://www.bmj.com/company/newsroom/long-term-exposure-to-air-pollution-linked-to-heightened-autoimmune-disease-risk/ ).


A big part of this pollution is generated by cars and other vehicles. Cities become a major critical points of pollution. 


This is where public transportation comes into play. A city with affordable, sustainable and effective public transportation systems allows the citizens to ditch the car in favor of a more viable alternative.

But creating an effective system is not a trivial matter. Public transportation systems usually suffer from delays that severely impact their performance and usability. Being able to predict and adapt timetables becomes a crucial task in order to prevent these problems and provide a quality service.








## 🔢 Data


Several datasets where provided for this challenge. There are two types:


1. NOS Data
2. TIP Data


NOS Data is data extracted from phone signals and can be used to track the affluence of people between stations.


TIP Data contains the ticket validations of users in every train and metro stop. 


At first we wanted to use all the data available. It was soon clear that we would obtain much better results if we limited the scope. NOS Data can be quite insightful, but it is based on the geolocation of the individuals and these might as well not be using neither train nor metro services. We decided not to use it for this specific challenge.


Secondly, the TIP Data contains information of two types of services: trains and metros. In our personal experience as public transportation users, metros have always been the most prone to issues and delays, so we decided to focus on Metro do Porto.




## 🧮 Methods and Techniques


Our whole analysis is done in Python. We used some popular Python libraries (numpy, pandas, matplotlib, plotlib, sklearn, xgboost, stata). 


We first focus on making a comprehensive analysis, then create a baseline model and then elaborate more complex or specific ones.


Regarding methods and algorithms:
-        We performed a seasonal decomposition of the time series to understand trends and seasonality. 
-        We analyzed the stationarity by performing a Dickey-Fuller test. 
-        We performed a thorough feature engineering process that included computing Mutual Information, Permutation Importance, PCA and SHAP
-        We used KeplerGL to better understand the stops distribution and user validations per stop visually
-        We added different range lags to convert the timeseries to improve the predictive performance of our models
-        Used several Machine Learning models and compared their performance (RMSE Loss, Models: xgboost, catboost)
-        We create several models, each with a different target, to build up more consistent and useful results.


## 💡 Main Insights
There are several key takeaways from our analysis and our conclusions:


* COVID has had a huge impact in the metro system in Porto. The service had more users prior to the quarantine period and is now slowly rising back, but nowhere close to the original levels. This could mean several things, some of them listed here:
   * There has been a decrease in the quality of the metro system, making users less prone to using it
   * There has been a shift in the overall population trend. People no longer commute as often. This could be due to remote work becoming popular, allowing people to stay at home instead of spending countless of hours in the way to work.
   * Other alternatives, such as bikes, electric scooters, etc, are now available and a prefered alternative for users.
   * * Stops that are located in the city centre are shared between multiple lines and seem to be highly frequented, whereas others barely receive passengers. This creates quite an uneven distribution, where even during rush hours some stops receive a really low number of users. After doing a bit of research we discovered that in the year 2019, Porto bought 18 extra trains that would be progressively incorporated into the metro system. Based on our conclusions, it would be meaningful to create a short distance line high frequency line that only transitions between stops that are in the city centre (for example from Senhora da Hora to Bolhao) during peak hours and deploy some of these trains there.


## 🛠️ Product
### Definition
Comprehensive analysis of the user validations in Porto and regression models.


### Users


Mainly people in charge of logistics that can make use of our models to adapt their metro timetables and train frequencies


### Activities


We created several predictive models. They can be used to predict the future traffic in a specific stop, in a full line or in the whole metro system. These insights can then be used to improve planning, creating more efficient timetables that increase the metro frequency in specific time periods to adapt to an increase in user traffic, to better allocate new resources such as new trains or even to plan the creation of new lines for the city


### Output


Meaningful visualizations and future predictions.


## 🌍 Social Impact Measurement
### Outcome
Improving the effectiveness of public transportation by providing predictive systems that can then be used to improve the allocation of trains and create adaptable timetables. This has a direct impact socially, as it reduces the amount of vehicles, reduces pollution, improves the satisfaction of those using the service, etc


### Impact Metrics


* Predicted hourly user validations per stop


### Impact Measurement


Impact can be measured in many ways. Our models could be used to create dashboards that forecast the amount of users that could use the metro on specific days or hours. This information can then be used to, for example, incentivise the usage of public transportation in days with lower expected affluence (price reduction could be a good incentive or even making the service free for specific timeframes). One could also track the estimate over time and see how it correlates to user satisfaction. Ideally, the number of users should rise and the satisfaction of said users should, at the very least, remain the same.